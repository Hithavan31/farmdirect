edit 26 to 37 line in server to not delete the database once started



<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Farmer Orders - FarmDirect</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #fafafa;
      margin: 0;
    }

    .header {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }

    .header h1 {
      margin: 0;
      color: #333;
    }

    .nav-buttons {
      display: flex;
      gap: 10px;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      background: #667eea;
      color: white;
      transition: all 0.3s;
    }

    button:hover {
      background: #5568d3;
      transform: translateY(-1px);
    }

    .btn-danger {
      background: #e74c3c;
    }

    .btn-danger:hover {
      background: #c0392b;
    }

    .btn-success {
      background: #27ae60;
    }

    .btn-success:hover {
      background: #229954;
    }

    .btn-warning {
      background: #f39c12;
    }

    .btn-warning:hover {
      background: #e67e22;
    }

    .btn-secondary {
      background: #95a5a6;
    }

    .btn-secondary:hover {
      background: #7f8c8d;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      text-align: center;
    }

    .stat-card h3 {
      margin: 0 0 10px 0;
      font-size: 32px;
      color: #667eea;
    }

    .stat-card p {
      margin: 0;
      color: #666;
      font-size: 14px;
    }

    .order-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 5px solid #667eea;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }

    .order-card.pending {
      border-left-color: #f39c12;
    }

    .order-card.confirmed {
      border-left-color: #3498db;
    }

    .order-card.delivered {
      border-left-color: #27ae60;
    }

    .order-card.cancelled {
      border-left-color: #e74c3c;
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }

    .order-status {
      display: inline-block;
      padding: 5px 15px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
    }

    .status-confirmed {
      background: #d1ecf1;
      color: #0c5460;
    }

    .status-delivered {
      background: #d4edda;
      color: #155724;
    }

    .status-cancelled {
      background: #f8d7da;
      color: #721c24;
    }

    .order-details {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      margin: 10px 0;
    }

    .order-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .order-actions button {
      flex: 1;
      padding: 8px 15px;
      font-size: 14px;
    }

    .no-orders {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .no-orders h2 {
      margin: 0 0 10px 0;
      color: #666;
    }

    .error {
      color: #e74c3c;
      padding: 10px;
      background: #fee;
      border-radius: 5px;
      margin: 10px 0;
      display: none;
    }

    .success {
      color: #27ae60;
      padding: 10px;
      background: #efe;
      border-radius: 5px;
      margin: 10px 0;
      display: none;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
      font-size: 18px;
    }

    .filter-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }

    .filter-tab {
      padding: 10px 20px;
      border: 2px solid #ddd;
      background: white;
      color: #666;
      cursor: pointer;
      border-radius: 5px;
      transition: all 0.3s;
    }

    .filter-tab:hover {
      border-color: #667eea;
    }

    .filter-tab.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .payment-badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 10px;
      font-size: 11px;
      font-weight: bold;
      margin-left: 10px;
    }

    .payment-upi {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .payment-cod {
      background: #fff3e0;
      color: #e65100;
    }
  </style>
</head>
<body>

<div class="header">
  <h1>üì¶ Order Management</h1>
  <div class="nav-buttons">
    <button onclick="goToDashboard()">Back to Dashboard</button>
    <button onclick="logout()" class="btn-danger">Logout</button>
  </div>
</div>

<div class="error" id="error-msg"></div>
<div class="success" id="success-msg"></div>

<div class="stats-grid">
  <div class="stat-card">
    <h3 id="total-orders">0</h3>
    <p>Total Orders</p>
  </div>
  <div class="stat-card">
    <h3 id="pending-orders">0</h3>
    <p>Pending Orders</p>
  </div>
  <div class="stat-card">
    <h3 id="total-revenue">‚Çπ0</h3>
    <p>Total Revenue</p>
  </div>
</div>

<div class="filter-tabs">
  <button class="filter-tab active" onclick="filterOrders('all')">All Orders</button>
  <button class="filter-tab" onclick="filterOrders('pending')">Pending</button>
  <button class="filter-tab" onclick="filterOrders('confirmed')">Confirmed</button>
  <button class="filter-tab" onclick="filterOrders('delivered')">Delivered</button>
  <button class="filter-tab" onclick="filterOrders('cancelled')">Cancelled</button>
</div>

<h2>Received Orders</h2>
<div id="orders-container">
  <div class="loading">Loading orders...</div>
</div>

<script>
// Get auth data from URL parameters
const urlParams = new URLSearchParams(window.location.search);
const authToken = urlParams.get('token');
const userRole = urlParams.get('role');
const userId = urlParams.get('userId');

// Check authentication
if (!authToken || userRole !== 'farmer') {
  alert("Unauthorized access. Please login as a farmer.");
  window.location.href = "login.html";
}

let allOrders = [];
let currentFilter = 'all';

function showError(message) {
  const errorEl = document.getElementById('error-msg');
  errorEl.textContent = message;
  errorEl.style.display = 'block';
  document.getElementById('success-msg').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function showSuccess(message) {
  const successEl = document.getElementById('success-msg');
  successEl.textContent = message;
  successEl.style.display = 'block';
  document.getElementById('error-msg').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

async function loadOrders() {
  try {
    console.log('Loading farmer orders with token:', authToken ? 'Present' : 'Missing');
    
    const res = await fetch('http://localhost:3000/orders/farmer', {
      headers: {
        'Authorization': `Bearer ${authToken}`
      }
    });

    console.log('Response status:', res.status);

    if (!res.ok) {
      const errorData = await res.json();
      console.error('Error response:', errorData);
      throw new Error(errorData.error || 'Failed to load orders');
    }

    allOrders = await res.json();
    console.log('Orders loaded:', allOrders.length);
    updateStats();
    displayOrders();
  } catch (error) {
    console.error('Load orders error:', error);
    showError('Failed to load orders: ' + error.message);
    document.getElementById('orders-container').innerHTML = `
      <div class="no-orders">
        <h2>Error loading orders</h2>
        <p>${error.message}</p>
        <p>Check console for details</p>
      </div>
    `;
  }
}

function updateStats() {
  const totalOrders = allOrders.length;
  const pendingOrders = allOrders.filter(o => o.status === 'pending').length;
  const totalRevenue = allOrders
    .filter(o => o.status === 'delivered')
    .reduce((sum, o) => sum + o.totalAmount, 0);

  document.getElementById('total-orders').textContent = totalOrders;
  document.getElementById('pending-orders').textContent = pendingOrders;
  document.getElementById('total-revenue').textContent = '‚Çπ' + totalRevenue.toFixed(2);
}

function displayOrders() {
  const container = document.getElementById('orders-container');
  
  let filteredOrders = allOrders;
  if (currentFilter !== 'all') {
    filteredOrders = allOrders.filter(o => o.status === currentFilter);
  }

  if (filteredOrders.length === 0) {
    container.innerHTML = `
      <div class="no-orders">
        <h2>üì≠ No ${currentFilter === 'all' ? '' : currentFilter} orders yet</h2>
        <p>Orders will appear here when retailers place them</p>
      </div>
    `;
    return;
  }

  container.innerHTML = '';

  filteredOrders.forEach(order => {
    const date = new Date(order.orderDate).toLocaleString('en-IN');
    const statusClass = `status-${order.status}`;
    
    const div = document.createElement('div');
    div.className = `order-card ${order.status}`;
    div.innerHTML = `
      <div class="order-header">
        <div>
          <h3 style="margin: 0 0 5px 0;">Order #${order._id.slice(-6).toUpperCase()}</h3>
          <span class="order-status ${statusClass}">${order.status}</span>
          <span class="payment-badge payment-${order.paymentMethod}">${order.paymentMethod.toUpperCase()}</span>
          <p style="margin: 10px 0 0 0; color: #999; font-size: 13px;">${date}</p>
        </div>
        <div style="text-align: right;">
          <strong style="font-size: 24px; color: #667eea;">‚Çπ${order.totalAmount}</strong>
        </div>
      </div>

      <div class="order-details">
        <p><strong>üõí Items Ordered:</strong></p>
        <ul style="margin: 5px 0; padding-left: 20px;">
          ${order.items.map(item => `
            <li>${item.produceName} - ${item.quantity} units @ ‚Çπ${item.price} each</li>
          `).join('')}
        </ul>
      </div>

      <p><strong>üìç Delivery Address:</strong> ${order.deliveryAddress}</p>
      <p><strong>üìû Customer Contact:</strong> ${order.contactNumber}</p>
      <p><strong>üöö Courier Preference:</strong> ${order.courierService}</p>
      
      ${order.paymentMethod === 'upi' && order.upiTransactionId ? 
        `<p><strong>üí≥ UPI Transaction ID:</strong> ${order.upiTransactionId}</p>` : ''}
      
      ${order.notes ? 
        `<p><strong>üìù Customer Notes:</strong> ${order.notes}</p>` : ''}

      <div class="order-actions">
        ${order.status === 'pending' ? `
          <button class="btn-success" onclick="updateOrderStatus('${order._id}', 'confirmed')">
            ‚úì Confirm Order
          </button>
          <button class="btn-danger" onclick="updateOrderStatus('${order._id}', 'cancelled')">
            ‚úó Cancel Order
          </button>
        ` : ''}
        
        ${order.status === 'confirmed' ? `
          <button class="btn-success" onclick="updateOrderStatus('${order._id}', 'delivered')">
            ‚úì Mark as Delivered
          </button>
        ` : ''}
        
        ${order.status === 'delivered' ? `
          <button disabled style="opacity: 0.6; cursor: not-allowed;">
            ‚úì Order Completed
          </button>
        ` : ''}
        
        ${order.status === 'cancelled' ? `
          <button disabled style="opacity: 0.6; cursor: not-allowed; background: #e74c3c;">
            ‚úó Order Cancelled
          </button>
        ` : ''}
      </div>
    `;
    
    container.appendChild(div);
  });
}

async function updateOrderStatus(orderId, newStatus) {
  const confirmMessages = {
    confirmed: 'Are you sure you want to confirm this order?',
    delivered: 'Are you sure you want to mark this order as delivered?',
    cancelled: 'Are you sure you want to cancel this order?'
  };

  if (!confirm(confirmMessages[newStatus])) {
    return;
  }

  try {
    const res = await fetch(`http://localhost:3000/orders/${orderId}/status`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${authToken}`
      },
      body: JSON.stringify({ status: newStatus })
    });

    const data = await res.json();

    if (res.ok) {
      showSuccess(`Order ${newStatus} successfully!`);
      loadOrders(); // Reload orders
    } else {
      showError(data.error || 'Failed to update order status');
    }
  } catch (error) {
    showError('Network error: ' + error.message);
  }
}

function filterOrders(status) {
  currentFilter = status;
  
  // Update active tab
  document.querySelectorAll('.filter-tab').forEach(tab => {
    tab.classList.remove('active');
  });
  event.target.classList.add('active');
  
  displayOrders();
}

function goToDashboard() {
  const params = new URLSearchParams({
    token: authToken,
    role: userRole,
    userId: userId
  });
  window.location.href = 'farmers.html?' + params.toString();
}

function logout() {
  if (confirm("Are you sure you want to logout?")) {
    window.location.href = "login.html";
  }
}

// Load orders on page load
loadOrders();

// Auto-refresh every 30 seconds
setInterval(loadOrders, 30000);
</script>

</body>
</html>






https://images.unsplash.com/photo-1595667365337-1112f4ff5d1f?w=800&h=1000&fit=crop




index.html

<!doctype html>
<html>
<head>
  <title>FarmDirect - Connect Farmers & Retailers</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .container {
      display: flex;
      min-height: 100vh;
      max-width: 1400px;
      margin: 0 auto;
    }

    .left-section {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      position: relative;
    }

    .farmer-image-container {
      position: relative;
      max-width: 600px;
      width: 100%;
    }

    .farmer-image-container img {
      width: 100%;
      height: auto;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .image-overlay {
      position: absolute;
      bottom: 30px;
      left: 30px;
      right: 30px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }

    .image-overlay h2 {
      color: #333;
      margin-bottom: 10px;
      font-size: 24px;
    }

    .image-overlay p {
      color: #666;
      font-size: 16px;
      line-height: 1.5;
    }

    .right-section {
      flex: 0 0 500px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    .login-box {
      background: white;
      padding: 50px 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 400px;
    }

    .logo {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo h1 {
      color: #667eea;
      font-size: 42px;
      margin-bottom: 10px;
    }

    .logo .tagline {
      color: #666;
      font-size: 16px;
    }

    .features {
      text-align: left;
      margin: 30px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
    }

    .features h3 {
      margin-top: 0;
      color: #667eea;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .features ul {
      list-style: none;
      padding: 0;
    }

    .features li {
      padding: 8px 0;
      color: #555;
      font-size: 14px;
    }

    .features li:before {
      content: "‚úì ";
      color: #27ae60;
      font-weight: bold;
      margin-right: 10px;
    }

    button {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
    }

    .btn-secondary:hover {
      background: #667eea;
      color: white;
      transform: translateY(-2px);
    }

    .divider {
      text-align: center;
      margin: 20px 0;
      color: #999;
      font-size: 14px;
    }

    @media (max-width: 1024px) {
      .container {
        flex-direction: column;
      }

      .left-section {
        min-height: 50vh;
      }

      .right-section {
        flex: 1;
      }
    }

    @media (max-width: 768px) {
      .left-section {
        padding: 20px;
      }

      .right-section {
        padding: 20px;
      }

      .login-box {
        padding: 30px 20px;
      }

      .logo h1 {
        font-size: 32px;
      }

      .image-overlay {
        bottom: 20px;
        left: 20px;
        right: 20px;
        padding: 15px;
      }

      .image-overlay h2 {
        font-size: 18px;
      }

      .image-overlay p {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Left Section - Farmer Image -->
  <div class="left-section">
    <div class="farmer-image-container">
     <img src="https://upload.wikimedia.org/wikipedia/commons/4/4e/India_Farming.jpg"
     alt="Indian Farming"
     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%221000%22%3E%3Crect fill=%22%234CAF50%22 width=%22800%22 height=%221000%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2240%22 fill=%22white%22 text-anchor=%22middle%22 dy=%22.3em%22%3Eüåæ Indian Farmer üåæ%3C/text%3E%3C/svg%3E'">

      <div class="image-overlay">
        <h2>Empowering Indian Farmers</h2>
        <p>Connecting farmers directly with retailers, ensuring fair prices and eliminating middlemen.</p>
      </div>
    </div>
  </div>

  <!-- Right Section - Login Box -->
  <div class="right-section">
    <div class="login-box">
      <div class="logo">
        <h1>üåæ FarmDirect</h1>
        <p class="tagline">Farm to Market, Directly</p>
      </div>

      <div class="features">
        <h3>Why FarmDirect?</h3>
        <ul>
          <li>Direct connection with farmers</li>
          <li>No middlemen, better prices</li>
          <li>Easy produce listing</li>
          <li>Secure transactions</li>
        </ul>
      </div>

      <button type="button" class="btn-primary" onclick="goLogin()">Login to Your Account</button>
      
      <div class="divider">Don't have an account?</div>
      
      <button type="button" class="btn-secondary" onclick="goRegister()">Register Now</button>
    </div>
  </div>
</div>

<script>
function goLogin() {
  window.location.href = "login.html";
}

function goRegister() {
  window.location.href = "register.html";
}
</script>

</body>
</html>








farmer-order.html

<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Farmer Orders - FarmDirect</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #fafafa; margin: 0; }
    .header { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
    .header h1 { margin: 0; color: #333; }
    .nav-buttons { display: flex; gap: 10px; }
    button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;
      font-weight: bold; background: #667eea; color: white; }
    .btn-danger { background: #e74c3c; }
    .btn-success { background: #27ae60; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
      gap: 20px; margin-bottom: 30px; }
    .stat-card { background: white; padding: 20px; border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08); text-align: center; }
    .order-card { background: white; padding: 20px; border-radius: 10px;
      margin-bottom: 20px; border-left: 5px solid #667eea;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
    .order-card.pending { border-left-color: #f39c12; }
    .order-card.confirmed { border-left-color: #3498db; }
    .order-card.delivered { border-left-color: #27ae60; }
    .order-card.cancelled { border-left-color: #e74c3c; }
    .order-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .order-status { padding: 5px 12px; border-radius: 15px; font-size: 12px;
      font-weight: bold; text-transform: uppercase; }
    .status-pending { background:#fff3cd; }
    .status-confirmed { background:#d1ecf1; }
    .status-delivered { background:#d4edda; }
    .status-cancelled { background:#f8d7da; }
    .payment-badge { margin-left: 10px; font-size: 11px; font-weight: bold;
      padding: 3px 10px; border-radius: 10px; }
    .payment-upi { background:#e8f5e9; color:#2e7d32; }
    .payment-cod { background:#fff3e0; color:#e65100; }
    .order-actions { display: flex; gap: 10px; margin-top: 15px; }
    .no-orders { text-align: center; padding: 40px; color: #888; }
  </style>
</head>
<body>

<div class="header">
  <h1>üì¶ Order Management</h1>
  <div class="nav-buttons">
    <button onclick="goToDashboard()">Back</button>
    <button onclick="logout()" class="btn-danger">Logout</button>
  </div>
</div>

<div class="stats-grid">
  <div class="stat-card"><h3 id="total-orders">0</h3><p>Total Orders</p></div>
  <div class="stat-card"><h3 id="pending-orders">0</h3><p>Pending</p></div>
  <div class="stat-card"><h3 id="total-revenue">‚Çπ0</h3><p>Revenue</p></div>
</div>

<div id="orders-container">Loading...</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const authToken = urlParams.get("token");
const userRole = urlParams.get("role");
const userId = urlParams.get("userId");

if (!authToken || userRole !== "farmer") {
  alert("Unauthorized");
  location.href = "login.html";
}

let allOrders = [];

async function loadOrders() {
  const res = await fetch("http://localhost:3000/orders/farmer", {
    headers: { Authorization: `Bearer ${authToken}` }
  });
  allOrders = await res.json();
  updateStats();
  displayOrders();
}

function updateStats() {
  document.getElementById("total-orders").textContent = allOrders.length;
  document.getElementById("pending-orders").textContent =
    allOrders.filter(o => o.status === "pending").length;
  document.getElementById("total-revenue").textContent =
    "‚Çπ" + allOrders.filter(o => o.status === "delivered")
      .reduce((s,o)=>s+(o.totalAmount||0),0);
}

function displayOrders() {
  const c = document.getElementById("orders-container");
  if (!allOrders.length) {
    c.innerHTML = `<div class="no-orders">No orders yet</div>`;
    return;
  }
  c.innerHTML = "";
  allOrders.forEach(o => {
    const payment = o.paymentMethod
      ? `<span class="payment-badge payment-${o.paymentMethod}">
          ${o.paymentMethod.toUpperCase()}
        </span>` : "";

    const items = Array.isArray(o.items) && o.items.length
      ? o.items.map(i =>
          `<li>${i.produceName || "Item"} - ${i.quantity || 0} @ ‚Çπ${i.price || 0}</li>`
        ).join("")
      : "<li>No items</li>";

    c.innerHTML += `
      <div class="order-card ${o.status}">
        <div class="order-header">
          <div>
            <b>Order #${o._id?.slice(-6) || "N/A"}</b>
            <span class="order-status status-${o.status}">${o.status}</span>
            ${payment}
          </div>
          <b>‚Çπ${o.totalAmount || 0}</b>
        </div>

        <ul>${items}</ul>
        <p><b>Address:</b> ${o.deliveryAddress || "N/A"}</p>

        <div class="order-actions">
          ${o.status === "pending" ? `
            <button class="btn-success" onclick="updateStatus('${o._id}','confirmed')">Confirm</button>
            <button class="btn-danger" onclick="updateStatus('${o._id}','cancelled')">Cancel</button>
          ` : ""}
          ${o.status === "confirmed" ? `
            <button class="btn-success" onclick="updateStatus('${o._id}','delivered')">Delivered</button>
          ` : ""}
        </div>
      </div>`;
  });
}

async function updateStatus(id, status) {
  await fetch(`http://localhost:3000/orders/${id}/status`, {
    method: "PUT",
    headers: {
      "Content-Type":"application/json",
      Authorization:`Bearer ${authToken}`
    },
    body: JSON.stringify({ status })
  });
  loadOrders();
}

function goToDashboard() {
  location.href = `farmers.html?token=${authToken}&role=${userRole}&userId=${userId}`;
}
function logout() { location.href = "login.html"; }

loadOrders();
</script>

</body>
</html>
